# 学習管理アプリケーション 要件定義書

**データモデル詳細**: [data-model.md](./data-model.md) を参照

---

## 1. 共通レイアウト（Layout）

|**項目**|**種別**|**内容・機能**|
|---|---|---|
|**ヘッダー：ストリーク**|表示|現在の連続達成日数（例：`🔥 12 days`）を表示。Bronze以上を連続で達成した日数をカウント。記録をしなかった日があった場合はリセットされる。|
|**ヘッダー：記録ボタン**|ボタン|**最重要アクション。** 押下で「記録画面」へ遷移。|
|**提案バナー**|通知|画面右下に固定表示される通知形式のバナー。条件を満たした場合のみ表示され、×ボタンで閉じることができる。|

---

## 2. ホーム画面（Dashboard）

「過去の学習履歴」を一覧し、モチベーションを維持する画面です。

### デイリーレポートカード一覧

過去の学習記録をグリッド形式（2-3列）で表示します。新しい順（今日が最上位）に並びます。

#### カードの構成要素

各カードには以下の情報を表示：

- **日付**: 「2025年12月31日（火）」形式で表示

- **達成度バッジ**: Bronze / Silver / Gold / 未記録 のいずれかを色付きバッジで表示

- **学習内容サマリー**:

    - ユーザーが入力した学習内容を箇条書き形式（最大3件）で表示

    - 入力がない場合は「学習内容の記録なし」と表示

- **日報の抜粋**:

    - 自由記述（Journal）がある場合、冒頭100文字程度を表示

    - ない場合は「日報なし」と表示

- **カードクリック**: カード全体がクリッカブル。押下でその日の「日詳細画面（読み取り専用）」へ遷移


#### 表示件数とレイアウト

- グリッド表示: PC画面で見栄えが良いように2-3列のグリッドレイアウトで表示
- 初期表示: 直近の記録を表示（PCで最適な表示となる日数）


### 提案バナー（共通レイアウト）

画面右下に固定表示される通知形式のバナーです。条件を満たした場合のみ表示されます。

- **表示位置**: 画面右下に固定
- **閉じる機能**: ×ボタンで閉じることができる
- **メッセージ**: 「レベルアップの条件を満たしました」or「目標をレベルダウンしませんか？」等のテキスト
- **アクションボタン**: 押下で「目標編集画面」へ遷移

#### 表示条件と編集権限
- **レベルアップ提案**:
    - **Gold を14日連続達成**: Gold目標のみ編集可能
    - **Silver を14日連続達成**: Silver目標のみ編集可能
    - **Bronze を14日連続達成**: Bronze目標のみ編集可能
- **レベルダウン提案**: 1週間のうち、Bronzeすら4日以上達成できなかった場合（全目標の編集が可能）
        

---
## 3. 記録・日報画面（Daily Recording）

その日の学習成果を記録し、振り返りを行う画面です。

### 学習内容サマリー（必須）

- **入力形式**: 箇条書き形式で複数項目を入力（テキストエリア）
- **プレースホルダー**: 「なし」（灰色で表示）
- **入力例**:
    - Reactのコンポーネント設計を学習
    - TypeScriptの型定義を復習
    - データベーススキーマの設計
- **補足**: 何も作業していない場合は「なし」と入力

### 目標達成度（3-Step Cards）

その日の実際の達成度を選択します。

| **Bronze** | **Silver** | **Gold**   |
| ---------- | ---------- | ---------- |
| **「最低限」**  | **「計画通り」** | **「期待以上」** |
| 30分だけ座る    | 1機能完成      | リファクタまで完了  |
| [ 選択する ]   | [ 選択する ]   | [ 選択する ]   |

### 自由記述（Journal）（任意）

- **内容**: 今日感じたこと、学んだこと、自分への褒め言葉など
- **入力形式**: テキストエリア

---

### アクションボタン

- **[ 記録を確定してロックする ]**

    - ※保存後、今日の記録は読み取り専用になり、ダッシュボードへ遷移します。
        

---


## 4. 目標編集画面（Goal Adjustment）

**提案バナー経由でのみアクセス可能**。「目標そのもの」を書き換える画面です。

### アクセス条件

- **レベルアップ提案時（14日連続達成）**: 提案バナーのボタンから遷移可能
- **レベルダウン提案時（7日中4日未達）**: 提案バナーのボタンから遷移可能
- **上記以外**: 目標編集画面へのアクセスは不可（編集ロック状態）

### 編集入力フォーム

- **Bronze目標入力**: テキストボックス。
- **Silver目標入力**: テキストボックス。
- **Gold目標入力**: テキストボックス。

### 更新ボタン

- 入力した内容を新しい基準として保存
- 保存時、現在の目標期間（スロット）が確定し、新しい目標期間が開始される
- 目標変遷画面のタイムラインに新しいスロットが追加される

---

## 5. 目標変遷画面（Goal Progress Race）

目標（Bronze/Silver/Gold）の成長プロセスを、**デッドヒート形式の横棒グラフアニメーション**で可視化する画面です。**各目標レベル（Bronze/Silver/Gold）は独立して管理され**、それぞれが「レベル（Lv.）」を持ち、14日連続達成でレベルアップ・目標内容が更新されます。過去から現在までの成長の軌跡を、まるで登録者数が増えていくような高揚感とともに体験できます。

### アクセス方法

- サイドバーのメニュー項目「目標変遷」から遷移
- メニュー順序: ホーム → 記録 → カレンダー → 目標変遷 → 設定

### 画面構成要素

#### ① デッドヒート表示（横棒グラフ）

**レイアウト:**
- **縦軸**: Bronze、Silver、Goldの3行（すべて英語表記で統一）
- **横軸**: 0〜14日のカウント（ゲージ）
- **バーのラベル**: 各バーの左側に現在の目標内容を大きく表示（例：「Silver：120分」）
- **バーの色**: Bronze=銅色、Silver=銀色、Gold=金色（カラーパレット参照）

**バーの動き（アニメーション）:**
- アニメーションが始まると、実績データに基づいてバーが右に伸びていく
- 14日に到達すると「LEVEL UP!」エフェクトが発動し、バーが0にリセット
- 同時にラベルの目標内容が新しい内容に切り替わる（例：「Silver：120分」→「Silver：150分」）
- レベルダウン（目標調整）時は「ADJUST!」エフェクトが表示され、目標内容のみが静かに切り替わる（レベルは横ばい）
- アニメーションは過去から現在まで全履歴を通して再生される

#### ② レベル表示とバッジ

**現在のレベル表示:**
- 画面上部に各レベルの現在の到達レベルを表示（例：「Bronze Lv.3」「Silver Lv.7」「Gold Lv.14」）
- 各レベルは独立してカウントされる
- 表記は全てBronze/Silver/Goldの英語表記で統一

**レベル称号システム:**
- Bronze、Silver、Goldそれぞれが独立したレベル（Lv.）を持つ
- 14日連続達成ごとにそのレベルのLv.が1つ上がる
- レベルダウン（7日中4日未達による目標調整）時はレベルは横ばいのまま、目標内容のみ変更される

#### ③ 再生コントロール

**初期表示:**
- **画面を開いた時点では、最新（現在）の状態を静止画で表示**
- 現在のレベルと進捗状況が一目でわかるように、最終フレームの状態を表示
- ユーザーは画面を開いた瞬間に「今どの状態にいるか」を把握できる

**再生ボタン:**
- 画面下部に配置
- 押下でアニメーションが過去の初期状態から開始され、現在まで再生される
- 再生中は一時停止ボタンに切り替わる

**リセットボタン:**
- アニメーション終了後、再度最初から見たい場合に使用
- 押下で最初の状態に巻き戻る

**再生速度:**
- 標準速度で全履歴を再生
- ユーザーが途中で飽きないよう、適度なスピード感を保つ

#### ④ レベル履歴詳細モーダル

**アクセス方法:**
- 各バー（Bronze・Silver・Gold）のラベル部分をクリック
- モーダルウィンドウが開き、そのレベルの変遷履歴が表示される

**モーダルの表示内容:**
- **ヘッダー**: 「Bronzeの履歴」「Silverの履歴」「Goldの履歴」（英語表記で統一）
- **レベル履歴リスト**: そのレベルの全ての変遷を時系列で表示
  - 例：「Lv.1：15分」「Lv.2：30分」...「Lv.14：180分」
  - **レベルアップ/調整バッジの表示ルール**:
    - 前のカード（Lv.N）がレベルアップで終了した場合、次のカード（Lv.N+1）に「↗️ レベルアップ」バッジを表示
    - 前のカード（Lv.N）が目標調整で終了した場合、次のカード（Lv.N+1）に「↘️ 目標調整」バッジを表示
    - 最初のカード（Lv.1）にはバッジを表示しない（初期状態のため）
- **総達成率**: そのレベルの目標をどれくらい達成できていたかの割合
  - 計算式：「そのレベルの目標を達成した日数 ÷ そのレベルでの総日数」
  - 例：「Bronze目標達成率：85%（120日中102日達成）」
- **期間情報**: 各レベルがいつからいつまで有効だったかの期間表示

### インタラクション

- **初期表示**: 静止画として、現在の最新状態のバーとレベルを表示（ユーザーは画面を開いた瞬間に現在の状況を把握できる）
- **再生ボタン押下**: アニメーションが過去の初期状態から開始され、現在までの全履歴が再生される
- **リセットボタン押下**: アニメーションが最初の状態に巻き戻る
- **レベルラベルクリック**: モーダルが開き、そのレベルの詳細履歴と総達成率が表示される
- **初回起動時**: 履歴がない場合は「まだ目標変更履歴がありません」と表示

### アニメーション演出

**レベルアップ時（14日連続達成）:**
- バーが14日に到達した瞬間に「LEVEL UP!」エフェクトが画面に表示
- エフェクトの色：ポジティブな色（青や緑、光の演出）
- バーが0にリセットされる
- ラベルの目標内容が新しい内容に切り替わる（例：「中級：120分」→「中級：150分」）
- そのレベルのLv.が1つ上がる

**レベルダウン時（7日中4日未達による目標調整）:**
- 「ADJUST!」エフェクトが画面に表示される
- エフェクトの色：警告を示す色（オレンジや黄色）
- レベルは横ばいのまま（Lv.は変わらない）
- 目標内容のみが新しい内容に静かに切り替わる（例：「中級：120分」→「中級：90分」）
- バーはリセットされず、次の期間のデータから継続して伸びていく

### ビジネスロジック（目標変更ルール）

**目標の独立性:**
- Bronze（初級）、Silver（中級）、Gold（上級）の各目標は**完全に独立して管理される**
- それぞれの目標が個別に14日連続達成または7日中4日未達の条件を満たした場合、その目標のみが変更される
- 例：Bronzeが14日連続達成でレベルアップしても、SilverとGoldは変更されない

**レベルの管理:**
- 各目標レベル（Bronze/Silver/Gold）は独立したレベル（Lv.）を持つ
- 14日連続達成ごとにそのレベルのLv.が1つ上がり、目標内容が更新される
- レベルダウン（7日中4日未達）時は、レベルは横ばいのまま、目標内容のみが調整される

**目標変更のタイミング:**
- 目標編集画面で「更新ボタン」を押した瞬間に、変更対象の目標の現在の期間が確定
- 新しい期間が開始され、デッドヒート画面のアニメーションデータに反映される
- 変更されなかった目標は、前の期間が継続される

**目標変更の前提条件:**
- 提案バナー経由でのみ目標編集画面へアクセス可能
- **レベルアップ提案時**: 14日連続達成した目標のみ編集可能
  - 例：Goldを14日連続達成した場合、Gold目標のみ編集可能
- **レベルダウン提案時**: 7日中4日未達の場合、全目標の編集が可能

---

## 6. カレンダー画面（Monthly Overview）

過去の頑張りを振り返るための画面です。

- **月次カレンダー**:
    
    - **日付セル**: 達成度に応じたカラー（銅・銀・金）で塗りつぶし、またはドットを表示。
        
    - **ホバーツールチップ**: 日付にマウスを乗せると「その日の目標」と「日報の冒頭」をポップアップ表示。
        
- **詳細リンク**: 日付クリックで、その日の「日詳細画面（読み取り専用）」へ。

### 日詳細画面（読み取り専用）

カレンダーから遷移する、過去の記録を閲覧する画面です。

- **表示内容**: その日の記録・日報画面で入力した全ての内容を表示
    - 日付
    - 達成度（Bronze/Silver/Gold）
    - 学習内容サマリー
    - 自由記述（Journal）

- **編集不可**: 確定後の記録は編集できず、読み取り専用として表示される。
    

---

## 6. 設定画面（Settings）

学習管理のルールを確認する画面です。

### ルール確認

- **レベルアップ提案**: 同じレベルを14日連続で達成した場合、目標をレベルアップすることを提案します。
- **レベルダウン提案**: Bronze未達が4日以上続いた場合、目標をレベルダウンすることを提案します。無理のないペースで続けることが大切です。

### 注意事項

- **GitHub連携機能は実装しません**: 外部サービスとの連携は行わず、学習管理に集中したシンプルな設計とします。


---

### UX向上のための「カラーパレット」提案

PC画面で長時間見ても疲れず、かつ「達成感」を感じられる配色です。

|**状態**|**推奨カラー**|**イメージ**|
|---|---|---|
|**未達**|`#E5E7EB` (Gray 200)|背景に溶け込む控えめな色。|
|**Bronze**|`#CD7F32` (Bronze)|落ち着いた銅色。温かみのあるブラウン。|
|**Silver**|`#94A3B8` (Slate 400)|洗練された銀色。少し青みのあるグレー。|
|**Gold**|`#F59E0B` (Amber 500)|鮮やかな金色。最も目立つ、達成の象徴。|

---
## 7. ユーザーフロー

### 毎日のサイクル

ユーザーが毎日通る基本的な流れです。

1. **記録画面へアクセス**
    - ヘッダーの「記録ボタン」から記録画面へ遷移

2. **その日の成果を記録**
    - 学習内容サマリーを入力（何を学んだか）
    - 達成度を選択（Bronze / Silver / Gold）
    - 自由記述で振り返りを記入（任意）

3. **記録を確定**
    - 「記録を確定してロックする」ボタンを押下
    - 記録が読み取り専用になり、ダッシュボードへ遷移

4. **過去の記録を振り返る**
    - ダッシュボードで過去の学習履歴を確認
    - カレンダー画面で月次の達成状況を俯瞰

### 目標調整のフロー

1. **提案バナーの表示**
    - レベルアップ条件達成時（14日連続達成）
    - レベルダウン提案時（7日中4日未達）

2. **目標編集画面へ遷移**
    - 提案バナーのボタンから目標編集画面へ

3. **目標を更新**
    - 新しい目標内容を入力
    - 更新ボタンで保存